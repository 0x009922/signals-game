# Прокрутка и скейл поля элементов

## Что надо сделать

Надо запилить возможность перемещать область видимости при помощи мыши. Зажал, передвинул, отпустил (или за край ушёл).

**С помощью колёсика** можно снижать и увеличивать масштаб. При этом, во время прокрутки, важно сохранять место, в которое указывает мышь. То есть зумить относительно положения мыши.

`viewBox` должен всегда быть пропорционален размеру всего канваса. Если размер канваса меняется, центр изображения должен оставаться на своём месте

Допустим, есть некий `baseSize` - число

Есть вектор `origin { x, y }`, который отвечает за то, где расположено начало координат (относительно верхнего левого угла). Величина в абсолютных пикселях или в относительном виде? **В относительном**, в системе координат конвы. Она простая - клеточка это единица. `baseSize` - это сколько единичная клеточка занимает на конечном экране при `zoom` = 1. Если `zoom` = 2, то клетка будет занимать `baseSize * 2` пикселей.

Исходя из этого, как считать `viewBox`?

Беру ширину бокса svg. (boundingBox). Допустим, 600px. Если baseSize = 100, а zoom = 1, то какая ширина viewBox?
6 единиц. Потому что в ширину 600px помещается (1 \* 100) размер клетки 6 раз. Если zoom = 2, то ширина viewBox была бы 3.

**Следовательно**: `viewBox = _ _ [svgWidth / (zoom * baseSize)] [svgHeight / (zoom * baseSize)]`. С шириной и высотой viewBox разобрались

Что насчёт смещения?

Если `origin { 3, 5 }`, то относительное смещение будет в противоположную сторону. И умноженное на zoom?

1 пиксель перемещения на в абсолютной системе есть

---

Зум должен происходить к курсору. Это значит, что точка под курсором в относительной системе координат до и после зума должна занимать одно и то же положение в абсолютной системе координат.

Какая связь между абсолютной и относительной позицией?

```
p_rel_x = p_abs_x * (1 / (zoom * base)) - width_abs * 0.5
```
